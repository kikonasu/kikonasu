<!--
  TRIGGER: week_midweek_check
  WHEN: Wednesday 8am
  FREQUENCY: Weekly
  SUBJECT: "Midweek outfit check: How's your week going?"
  PREVIEW: "{{remainingDays}} days left - here's what's coming up"
-->

<!-- Midweek Banner -->
<tr>
  <td style="background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); padding: 20px 24px; text-align: center;">
    <p style="font-size: 14px; font-weight: 600; color: #78350f; text-transform: uppercase; letter-spacing: 1px; margin: 0;">
      Midweek Check-in
    </p>
  </td>
</tr>

<!-- Main Content -->
<tr>
  <td class="content-section" style="padding: 32px 24px;">

    <!-- Greeting -->
    <h1 class="greeting" style="font-size: 24px; font-weight: 600; color: #1a1a1a; margin: 0 0 16px 0;">
      Happy Wednesday, {{userName}}!
    </h1>

    <p class="body-text" style="font-size: 16px; line-height: 1.6; color: #4a4a4a; margin: 0 0 24px 0;">
      You're halfway through the week. Let's make sure you're set for the rest of it.
    </p>

    <!-- Upcoming Weather -->
    <p style="font-size: 14px; font-weight: 600; color: #374151; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 16px 0;">
      Rest of the Week
    </p>

    <table role="presentation" style="width: 100%; border: none; border-spacing: 0; margin: 0 0 24px 0;">
      {{#each remainingDays}}
      <tr>
        <td style="padding: 12px 0; border-bottom: 1px solid #f3f4f6;">
          <table role="presentation" style="width: 100%; border: none; border-spacing: 0;">
            <tr>
              <td style="width: 80px;">
                <p style="font-size: 14px; font-weight: 600; color: #374151; margin: 0;">{{this.dayName}}</p>
              </td>
              <td style="width: 40px; text-align: center;">
                <span style="font-size: 24px;">{{this.icon}}</span>
              </td>
              <td>
                <p style="font-size: 15px; color: #1a1a1a; margin: 0;">{{this.high}}° / {{this.low}}°</p>
              </td>
              <td style="text-align: right;">
                {{#if this.hasPlannedOutfit}}
                <span style="background-color: #d1fae5; color: #065f46; font-size: 12px; padding: 4px 8px; border-radius: 4px;">Planned</span>
                {{else}}
                <span style="background-color: #fef3c7; color: #92400e; font-size: 12px; padding: 4px 8px; border-radius: 4px;">Open</span>
                {{/if}}
              </td>
            </tr>
          </table>
        </td>
      </tr>
      {{/each}}
    </table>

    <!-- Weather Alert if significant change -->
    {{#if weatherAlert}}
    <div style="background-color: #fef3c7; border-radius: 12px; padding: 16px; margin: 0 0 24px 0; border-left: 4px solid #f59e0b;">
      <table role="presentation" style="width: 100%; border: none; border-spacing: 0;">
        <tr>
          <td style="width: 30px; vertical-align: top;">
            <span style="font-size: 18px;">&#9888;</span>
          </td>
          <td style="font-size: 14px; color: #92400e;">
            <strong>Heads up:</strong> {{weatherAlert}}
          </td>
        </tr>
      </table>
    </div>
    {{/if}}

    <!-- Quick Outfit Suggestion -->
    {{#if suggestedOutfit}}
    <div style="background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 16px; padding: 20px; margin: 0 0 24px 0;">
      <p style="font-size: 14px; font-weight: 600; color: #7c3aed; margin: 0 0 12px 0;">
        &#10024; Outfit idea for {{suggestedOutfit.day}}
      </p>
      <table role="presentation" style="width: 100%; border: none; border-spacing: 0;">
        <tr>
          {{#each suggestedOutfit.items}}
          <td style="width: 33.33%; padding: 8px; text-align: center; vertical-align: top;">
            <img src="{{this.imageUrl}}" alt="{{this.category}}" style="width: 100%; max-width: 80px; height: auto; border-radius: 8px;">
          </td>
          {{/each}}
        </tr>
      </table>
      <p style="font-size: 13px; color: #6b7280; margin: 12px 0 0 0; text-align: center;">
        Based on {{suggestedOutfit.day}}'s forecast: {{suggestedOutfit.weather}}
      </p>
    </div>
    {{/if}}

    <!-- Weekend Preview -->
    {{#if weekendPlans}}
    <div class="highlight-box" style="background-color: #f0fdf4; border-radius: 12px; padding: 16px 20px; margin: 0 0 24px 0; border-left: 4px solid #22c55e;">
      <p style="font-size: 14px; font-weight: 600; color: #166534; margin: 0 0 8px 0;">
        &#127774; Weekend is coming!
      </p>
      <p style="font-size: 14px; color: #15803d; margin: 0;">
        Weather looks {{weekendPlans.summary}}. Perfect for {{weekendPlans.suggestion}}.
      </p>
    </div>
    {{/if}}

    <!-- CTA -->
    <table role="presentation" style="width: 100%; border: none; border-spacing: 0;">
      <tr>
        <td align="center" style="padding: 8px 0;">
          <a href="{{appUrl}}/outfit" class="cta-button" style="display: inline-block; background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%); color: #ffffff; font-size: 16px; font-weight: 600; padding: 16px 32px; border-radius: 12px; text-decoration: none;">
            Generate Outfit Ideas
          </a>
        </td>
      </tr>
      {{#if hasWeekPlan}}
      <tr>
        <td align="center" style="padding: 8px 0;">
          <a href="{{appUrl}}/suitcase/{{weekPlanId}}" class="secondary-button" style="display: inline-block; background-color: #f3f4f6; color: #4b5563; font-size: 14px; font-weight: 500; padding: 12px 24px; border-radius: 8px; text-decoration: none;">
            View Week Plan
          </a>
        </td>
      </tr>
      {{/if}}
    </table>

  </td>
</tr>
